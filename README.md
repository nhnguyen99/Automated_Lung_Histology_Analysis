# Automated Lung Histology Analysis

## Introduction 
Respiratory disease is one of the leading causes of human death in the United States, especially during the COVID-19 pandemic. Current pathological analysis of respiratory heavily relies upon the pathologist’s identification, which requires substantial workload. 

In this study, we aim to develop image analysis tools to automatically study the structural information from lung histology images under multiple respiratory disease patterns. In particular, we are working towards image processing tools that can be generally applied to process pathological lung images and extract key metrics to describe the difference among disease. We statistically compare the structural features of alveoli among multiple diseased lungs to find common patterns. 
 
## Materials and Methods
The dataset was acquired from the publicly available University of Michigan Virtual Slide Box website [1] , which contains histology images with different lung diseases. We randomly chose eleven images from patients diagnosed with tuberculosis, pneumonia, and hypertension. From each patient (image), three alveolar regions were selected for the analysis.  Specifically, we focus on the regions that are air-filled and exclude large airways and vessels. The total alveolar regions analyzed are tuberculosis (n = 9), pneumonia (n = 15), and hypertension (n = 9). 

We hypothesize that the difference between subregions can be quantified by a processed image using the metric of air-filled alveolar space ratio, namely aeration. To test this hypothesis, we developed an image processing tool and use statistics to investigate the differences among the three patterns. We first imported histology images cropped from ImageScope  12.4.3 . Then, histology images are split into its RGB channels. We further applied Otsu’s algorithm  on these greyscale images to highlight the non-air tissues including the alveolar walls, blood vessels, and cells, etc. Through this thresholding method, we acquired binary images in which black regions are blood vessels/alveolar walls and white regions are air-filled regions. Morphological operations such as dilation and erosion were also applied for noise reduction and image enhancement. Finally, we extract the evaluation metric by calculating the ratio of the white regions compared to the whole area of these greyscale images to collect the statistics by accepting significance at P less than 0.05 by analysis of variance (ANOVA).

## Results and Discussion
A demonstration of our image processing is shown in Fig. 1(a)-(b). Fig. 1(b) is an output binary image from the original histology subregion in Fig. 1(a). Fig. 1(c) shows statistics. The   tuberculosis patients have the highest percentage (83±3%) of white regions in comparison with the other two patterns that do not differ from each other (72±7% and 72±6% respectively). 



![image1](https://github.com/user-attachments/assets/e3641076-9aae-464d-a5c1-b8c5f111639b)  ![image2](https://github.com/user-attachments/assets/4a5a1200-6927-4b13-ab83-b84b93b85811)  ![image3](https://github.com/user-attachments/assets/1130e993-c26a-41ad-8c49-8e233455023d)

Figure 1. a) Original histology image; b) Binary mask generated by our image processing method; c) Comparison of aeration across groups of disease. * P<0.05.

## Conclusions
From the data presented, we demonstrate that it is feasible to use our image processing tool to automatically quantify the air-filled alveolar space across differently diseased lungs. Future work will be towards the development of computational methods to distinguish other colored regions in lung histology. 

![BMES 2020 Final](https://github.com/user-attachments/assets/1262ee29-08b9-48a2-af43-a950b0c1d36e)
